Sorr for the code being so bad, I had to work on it in parallel with another project, but hey it works.
